{{ block title }}

    Proportion {{ player.round_number }}

{{ endblock }}

{{ block styles }}

  <style>

    body {
        margin: 0;
        font-size: 14px
    }

    table {
    margin: 20px auto; /* centers the table horizontally */
      border-collapse: collapse;
      text-align: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    th, td {
      border: 1px solid #ccc;
      padding: 0px 10px;
    }
    th {
      background: #f5f5f5;
    }

    .total-row th,
    .total-row td {
      padding-top: 10px;
      padding-bottom: 10px;
    }

    .total-over {
      color: red;
      font-weight: bold;
    }

    .fraction-inline {
        display: inline-block;
        position: relative;
        width: 1.4em;   /* smaller square */
        height: 1.4em;
        font-size: 14px;
        margin-left: 8px;
        margin-right: 10px;
        vertical-align: middle;
      }

    .fraction-inline .diagonal-line {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 140%;
        height: 1px;
        background: black;
        transform: translate(-50%, -50%) rotate(-45deg);
    }

    .fraction-inline .k-value {
        position: absolute;
        top: -3px;
        left: -5px;
        font-size: 0.9em;
        line-height: 1;
    }

    .fraction-inline .denominator {
        position: absolute;
        bottom: 0;
        right: -8px;
        font-size: 0.8em;
        line-height: 1;
    }

    .button-container {
        display: flex;
        justify-content: flex-end;
    }

    .submit-button {
        color: #fff;
        background-color: #007bff;
        border: 1px solid #007bff;
        font-size: 1rem;
        border-radius: 0.25rem;
        padding: 4px 12px;
        cursor: pointer;
        font-family: Arial, Helvetica, sans-serif;
        transition: background-color 0.2s ease, border-color 0.2s ease;
    }

    .submit-button:hover {
        background-color: #0056b3;
        border-color: #0056b3;
    }

    .submit-button:active {
        background-color: #004a99;
        border-color: #004a99;
    }


  </style>

{{ endblock }}

{{ block content }}

<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


  <script>
      document.addEventListener('DOMContentLoaded', function() {
          const fieldNames = [
              'zero_20', 'one_20','two_20','three_20','four_20','five_20',
              'six_20','seven_20','eight_20','nine_20','ten_20',
              'eleven_20','twelve_20','thirteen_20','fourteen_20','fifteen_20',
              'sixteen_20','seventeen_20','eighteen_20','nineteen_20','twenty_20'
          ];

          const totalCell = document.getElementById('total');

          function updateTotal() {
              let sum = 0;
              fieldNames.forEach(name => {
                  const input = document.getElementsByName(name)[0];
                  if (input && !isNaN(input.value) && input.value !== '') {
                      sum += parseFloat(input.value);
                  }
              });

              totalCell.textContent = sum;

              // turn red if sum > 100
              if (sum > 100) {
                  totalCell.classList.add('total-over');
              } else {
                  totalCell.classList.remove('total-over');
              }
          }

          // attach input listener to each field
          fieldNames.forEach(name => {
              const input = document.getElementsByName(name)[0];
              if (input) {
                  input.addEventListener('input', updateTotal);
              }
          });

          updateTotal();
      });
  </script>

</head>

<body>

<div  class="card-body">

  {{ if player.round_number == 1 }}
  <p>
      First, we want you to estimate, for each possible proportion of cooperative choices in the first part,
      <b>the fraction of participants who chose the cooperative option that number of times out of 20</b>.
      For each possible number of cooperative choices (0/20, 1/20, …, 20/20),
      we ask you to estimate how many participants out of 100 chose the cooperative option that number of times.
  </p>
  {{ endif }}
  {{ if player.round_number == C.NUM_ROUNDS }}
  <p>
      Lastly, we want you to estimate, for each possible proportion of cooperative choices in the first part,
      <b>the fraction of participants who chose the cooperative option that number of times out of 20</b>.
      For each possible number of cooperative choices (0/20, 1/20, …, 20/20),
      we ask you to estimate how many participants out of 100 chose the cooperative option that number of times.
  </p>
  {{ endif }}
  <p>
      For example, if you believe half of the participants never chose the cooperative option,
      write but 50 next to
        <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">0</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
        </span>.
      If you believe only 10 out of 100 people chose the cooperative option for half of the 20 rounds,
      then write 10 next to
        <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">10</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
        </span>.
  </p>
  <p>
<!--      For each possible proportion of cooperative choices in the first part,-->
<!--      how many participants out of 100 do you think choose the cooperative option that amount of times?-->
      Please give us your estimate for each proportion.
      <b>The total must sum up to 100.</b>
  </p>

    <table>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">0</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'zero_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">1</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'one_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">2</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'two_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">3</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'three_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">4</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'four_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">5</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'five_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">6</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'six_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">7</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'seven_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">8</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'eight_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">9</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'nine_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">10</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'ten_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">11</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'eleven_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">12</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'twelve_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">13</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'thirteen_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">14</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'fourteen_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">15</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'fifteen_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">16</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'sixteen_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">17</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'seventeen_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">18</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'eighteen_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">19</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'nineteen_20' %}</td>
      </tr>
      <tr>
        <th>
          <span class="fraction-inline">
            <span class="diagonal-line"></span>
            <span class="k-value">20</span>
            <span class="denominator">{{ C.number_of_trials }}</span>
          </span>
        </th>
        <td>{% formfield 'twenty_20' %}</td>
      </tr>
      <tr class="total-row">
        <th>Total</th>
        <td id="total" colspan="3">0</td>
      </tr>

    </table>
</div>

    <div style="display: flex; justify-content: flex-end">
        {% next_button %}
    </div>


</body>
</html>

{{ endblock }}
